## 前言——他山之石，可以攻玉

对于已经掌握了一门或者多门编程语言的人来说，入门新的编程语言的最快方式并不是直接“啃”该语言的基础知识，而是从自己的熟悉业务入手，通过对比相同业务的不同代码实现，建立起对新的编程语言的系统性认知。至于更深入更细节的知识，则需要通过后续不断地编码实践来掌握。持续不断地实践，是学习编程的不二法门。

本文旨在借 Java 之石，攻 Go 之玉。Java 最为广泛使用的领域毫无疑问是 Web 开发领域。因此本文就从 Web 开发入手，通过对多个具有代表性的业务进行代码实现的比较，帮助读者快速掌握 Go 语言。

## "Hello, World!"

![CleanShot 2024-07-01 at 20.22.31@2x.png](https://lucasji-obsidian-1322082073.cos.ap-shanghai.myqcloud.com/CleanShot%202024-07-01%20at%2020.22.31@2x.png)

上图中左边为 Java 代码，来自于文件 Main.java。右边为 Go 代码，来自于文件 main.go。两者运行的结果均为在控制台输出 "Hello, World!"

我们通过对比 Java 代码，分析下 Go 代码的各个部分：

1. 第一行 `package main` 定义了包名，指明这个 go 文件属于包 `main`。从这里我们可以看到，Go 语言同 Java 一样，也有”包“的概念。Java 中包的存在是为了解决类名冲突，同一个包下不可以有两个同名类，但是不同包可以。此外，包还可以将相关的类放在一起，使程序结构更加清晰、可维护性更高。这一点，同样也是 Go 中包的作用。
2. 第三行 `import "fmt"` 通过 `import` 关键词来导入 `fmt` 包，该包实现了格式化输入输出的函数 `Println`。Java 中导入其它类的关键词同样也是 `import`。
3. 第五行定义了 `main` 函数。和 Java 一样，Go 同样需要一个 `main` 函数来启动程序。

通过上述分析，我们可以看到，Go 的代码解构和 Java 大体类似，同样有包名，同样有函数，用样有 `import` 关键词（Java 代码中的 `System` 类属于包 `java.lang`，该包下的类在使用的时候可以不显示地导入），但是细微之处却有很多差别。

### 差别 1

Java 中的 `main` 函数需要定义在类 `Main` 中，但是 Go 却不需要。

### 差别 2

Java 引用的是一个类（`java.lang.System`）来格式化输出，Go 却直接引用包（`fmt`）。

### 差别 3

Java 中 的 `main` 函数前面有三个关键词分别为 `public`，`static` 和 `void`，但是 Go 中却只有一个 `func`。

### 差别 4

Java 中 `println` 函数开头字母小写，Go 的 `Println` 函数的开头字母却是大写。这两种写法只是代码风格的差异还是对程序的运行有切实的影响？

让我们从这些差别开始，具体地学习下 Go 中的 ”包（package）“和”函数“。

## 包 - package

包的作用是为了模块化代码，使得代码解构更加清晰。通过对不同包的导入，来对不同模块的代码进行复用。

### package 声明

Java 中的 package 声明和文件全路径一致，使用 `.` 分割文件夹。文件 `Vehicle.java` 的 package 声明：

```java
package cn.demo.basic;
```

其对应的文件目录结构如下：

![image.png](https://lucasji-obsidian-1322082073.cos.ap-shanghai.myqcloud.com/20240625101139.png)

Go 的 package 声明并没有层级结构，package 名称和 go 文件所在的目录名称保持一致。文件 `vehicle.go` 的 package 声明：

```go
package basic
```

![image.png](https://lucasji-obsidian-1322082073.cos.ap-shanghai.myqcloud.com/20240625101422.png)

### package 引用

Java 是面向对象的编程语言，一切引用以类为基本单位。在引用时要么引用一个具体的类

```java
import java.util.List;
```

要么使用 `*` 表示引用该 package 下的所有类

```java
import java.util.*;
```

Java 中一切皆为对象，类是一等公民，每一个 java 文件必定对应一个作用域为 `public` 的 Java 类。只有在类中才能定义函数和变量。package 只是多个 java 文件的目录，package 自身不能拥有函数或者变量。

Go 语言并不是一门面向对象的语言，Go 的 package 使用更为灵活，对应的是一组变量、函数和结构体的集合。所以，即使 Go 中有和 Java 中的“类”相同概念的 `Struct`，go 文件和 `Struct` 之间没有必然的联系。一个 go 文件中可以随意定义函数、变量或者是结构体。

在 Go 语言中，只能 `import` 一个 package。

```go
import "cn\demo\basic"
```

### 作用域

Java 中变量、方法和类的作用域范围有当前类、同一 package、继承类和其它 package 四种，通过关键词 `public`，`protected`，`default` 和 `private` 来设定。

对于 Go 来说，作用域就两种，同一 package 和不同 package。通过变量、方法或类的首字母大小写来控制。大写意味着不同 package 可见，同 Java 中的 `public`。小写意味着只有同一 package 可见，同 Java 中的 `default`。

### 总结

在深入学习了 Go 中“包”的知识后，对于前文所说的四种差别我们应当有了一定的认识。细心的读者一定能够注意到，笔者尚未对 [[#差别 3]] 中所提及的 `void` 关键词和 `func` 关键词作出解释，因为这些会放在下一部分“函数”中作出说明。

## 函数

> 在包 `mathematics` 下定义“相加”函数，该函数接收两个 `int` 类型的参数，返回两个参数相加的结果，返回值的类型同样为 `int`。

由于 Java 中类才是一等功能，函数和变量只能在类中定义，因此需要先定义一个类 `MyMath`，然后在该类中定义函数 `add`

```java
package cn.demo.mathematics;  
  
public class MyMath {  
  public static int add(int a, int b) {  
    return a + b;  
  }  
}
```

函数的使用

```java
package cn.demo;  
  
import cn.demo.mathematics.MyMath;

public class Main {  
  
  public static void main(String[] args) {  
    int a = 1;  
    int b = 1;  
    int add = MyMath.add(a, b);  
    System.out.println(add);  
  }
```

由于 `add` 函数被定义为静态方法，因此可以直接通过 `MyMath.add` 进行调用。如果 `add` 函数没有定义为静态方法的话，则先需要实例化 `MyMath` 对象 `MyMath myMath = new MyMath()`，再通过 `myMath` 对象调用 `add`：`myMath.add`。

在 [[#源文件]] 一节中，我们知道 Go 的 package 是一组变量、函数和类的集合。因此可以直接在 `go` 文件 `add.go` 中定义 `Add` 函数

```go
package mathematics  
  
func Add(x int, y int) int {  
    return x + y  
}
```

函数的使用

```go
package main  
  
import "fmt"  
import "proj-Go/cn/demo/mathematics"  
  
func main() {  
    var a = 1  
    var b = 2  
    var add = mathematics.Add(a, b)  
    fmt.Println(add)  
}
```

从 Java 和 Go 对于“相加”函数的定义和函数的使用可以看出很多区别。

1. 入参和返回值类型的位置：Java 中类型在变量命前面而 Go 相反。
2. 变量定义：Java 需要确定类型。Go 可以省略类型。
3. 变量赋值：Java 使用 `=`。Go 使用 `:=`。
